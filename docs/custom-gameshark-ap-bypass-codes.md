# Custom GameShark Bypasses In Tonyhax International

## [Spyro: Year Of The Dragon USA Rev 0](http://redump.org/disc/818/)

By MottZilla and Alex Free

This game scans memory regions and will trip an additional anti-tamper measure which will start breaking the game in subtle ways. While it does scan and check the APv2 protection module, the 'step counter' that tracks which part of the APv2 module is being executed is not part of that checked region in RAM. MottZilla found the address of this step counter to be 8007F08C in rev 0. I saw that this address counts up from 0x00 and goes to 0x0E. By using D0/80 code pairs to force each step back to zero, the function will briefly lock up but then return successfully after about 15 seconds.

You can prove this doesn't trip anti-tamper by putting a 100% completed save on a memory card, loading it in-game, and replaying the final boss and going through the credits. If the game doesn't kick you out of the final boss fight, delete your save data, and warp you to level 1 then it works (which it does I tested both rev 0 and rev 1, see below).

D007F08C 0001
8007F08C 0000
D007F08C 0002
8007F08C 0000
D007F08C 0003
8007F08C 0000
D007F08C 0004
8007F08C 0000
D007F08C 0005
8007F08C 0000
D007F08C 0006
8007F08C 0000
D007F08C 0007
8007F08C 0000
D007F08C 0008
8007F08C 0000
D007F08C 0009
8007F08C 0000
D007F08C 000A
8007F08C 0000
D007F08C 000B
8007F08C 0000
D007F08C 000C
8007F08C 0000
D007F08C 000D
8007F08C 0000
D007F08C 000E
8007F08C 0000

## [Spyro: Year Of The Dragon USA Rev 1](http://redump.org/disc/1217/)

By Alex Free and MottZilla

Step counter is at different RAM address for this version: 8007F23C

D007F23C 0001
8007F23C 0000
D007F23C 0002
8007F23C 0000
D007F23C 0003
8007F23C 0000
D007F23C 0004
8007F23C 0000
D007F23C 0005
8007F23C 0000
D007F23C 0006
8007F23C 0000
D007F23C 0007
8007F23C 0000
D007F23C 0008
8007F23C 0000
D007F23C 0009
8007F23C 0000
D007F23C 000A
8007F23C 0000
D007F23C 000B
8007F23C 0000
D007F23C 000C
8007F23C 0000
D007F23C 000D
8007F23C 0000
D007F23C 000E
8007F23C 0000
 
## [Hyper Value 2800: Hanafuda](http://redump.org/disc/15791/)

By Alex Free

8001844C 1440FFD jnz r2,80018444h
Fail and trigger screen

8001844C 1040FFFD jz r2,80018444h
Pass and don't run routine

D001844E 1440
8001844E 1040

## [Love Hina 2: Kotoba wa Konayuki no You ni](http://redump.org/disc/7370/) / [Love Hina: Ai wa Kotoba no Naka ni](http://redump.org/disc/7369/)

By Alex Free

801009FC 16200003 jnz r17,80100A0C
Fail and trigger screen

801009FC 12200003 jz r17,80100A0C
Pass and don't run routine

D01009FE 1620
801009FE 1220

## [Koneko mo Issho](http://redump.org/disc/6329/)

By Alex Free and MottZilla

801520D8 12020062 je r16,r2,80152264
Fail and trigger screen

801520D8 18000014 jrel 8015212C
Pass test commands

D01520D8 0062
801520D8 0014
D01520DA 1202
801520DA 1800


D016957C 001E
8016957C 0000
code generated via aprip to patch out readtoc and emulate a VC0 CDROM controller

Game locks up on detecting a PAL BIOS, below is the code generated by aprip for the fake PAL Bypass:
D0151952 1062
80151952 1800

So we can nop this out and have it never detect a PAL BIOS

80151950 1062000A je r3,r2,8015197C
locks up on PAL BIOS

80151950 00000000 nop
never detects PAL BIOS


D0151950 000A
80151950 0000
D0151952 1062
80151952 0000

Full Bypass:

Test commands force OK:
D01520D8 0062
801520D8 0014
D01520DA 1202
801520DA 1800

Fake a VC0 without ReadTOC:
D016957C 001E
8016957C 0000

Fake Non PAL BIOS:
D0151950 000A
80151950 0000
D0151952 1062
80151952 0000


# [i-mode mo Issho: Doko Demo Issho Tsuika Disc](http://redump.org/disc/20321/)

By Alex Free & MottZilla

This game was released very close to Koneko mo Issho by the same developer for the same game series, which resulted in aprip being able to successfully convert our Koneko mo Issho bypass to one for i-mode mo Issho: Doko Demo Issho Tsuika Disc:

alex@pop-os:~/dev/aprip$ ./aprip D01520D8 0062 kon imo
APrip v1.0.6 By Alex Free (C)2022-2023 (3-BSD)
https://alex-free.github.io/aprip

Mode: GameShark code converter
Got old game ver gameshark code address D01520D8
Got old game ver gameshark code type prefix: D0
Got old game RAM dump address 001520D8
Got old game ver gameshark code base address 001520D0
Got old game ver gameshark code base address offset for write value: 8
Got old game ver gameshark code value 0062
Write byte 1 in big endian 62
Write byte 2 in big endian 0
Loaded old game ver RAM dump file: kon (2097152 bytes in memory)
Loaded new game ver RAM dump file: imo (2097152 bytes in memory)
001520D0: 21
001520D1: 80
001520D2: 40
001520D3: 00
001520D4: FF
001520D5: FF
001520D6: 02
001520D7: 24
001520D8: 62
001520D9: 00
001520DA: 02
001520DB: 12
001520DC: 01
001520DD: 00
001520DE: 02
001520DF: 24
Confirmed gameshark code write byte 1: 62 in: kon
Confirmed gameshark code write byte 2: 0 in: kon

Got pattern match in imo starting at base address: 00152054
Got new write val offset at address: 0015205C
Got new game ver gameshark code: D015205C 0062
alex@pop-os:~/dev/aprip$ ./aprip D01520DA 1202  kon imo
APrip v1.0.6 By Alex Free (C)2022-2023 (3-BSD)
https://alex-free.github.io/aprip

Mode: GameShark code converter
Got old game ver gameshark code address D01520DA
Got old game ver gameshark code type prefix: D0
Got old game RAM dump address 001520DA
Got old game ver gameshark code base address 001520D0
Got old game ver gameshark code base address offset for write value: A
Got old game ver gameshark code value 1202
Write byte 1 in big endian 2
Write byte 2 in big endian 12
Loaded old game ver RAM dump file: kon (2097152 bytes in memory)
Loaded new game ver RAM dump file: imo (2097152 bytes in memory)
001520D0: 21
001520D1: 80
001520D2: 40
001520D3: 00
001520D4: FF
001520D5: FF
001520D6: 02
001520D7: 24
001520D8: 62
001520D9: 00
001520DA: 02
001520DB: 12
001520DC: 01
001520DD: 00
001520DE: 02
001520DF: 24
Confirmed gameshark code write byte 1: 2 in: kon
Confirmed gameshark code write byte 2: 12 in: kon

Got pattern match in imo starting at base address: 00152054
Got new write val offset at address: 0015205E
Got new game ver gameshark code: D015205E 1202
alex@pop-os:~/dev/aprip$ ./aprip D0151950 000A  kon imo
APrip v1.0.6 By Alex Free (C)2022-2023 (3-BSD)
https://alex-free.github.io/aprip

Mode: GameShark code converter
Got old game ver gameshark code address D0151950
Got old game ver gameshark code type prefix: D0
Got old game RAM dump address 00151950
Got old game ver gameshark code base address 00151950
Got old game ver gameshark code base address offset for write value: 0
Got old game ver gameshark code value 000A
Write byte 1 in big endian A
Write byte 2 in big endian 0
Loaded old game ver RAM dump file: kon (2097152 bytes in memory)
Loaded new game ver RAM dump file: imo (2097152 bytes in memory)
00151950: 0A
00151951: 00
00151952: 62
00151953: 10
00151954: 46
00151955: 00
00151956: 62
00151957: 28
00151958: 0E
00151959: 00
0015195A: 40
0015195B: 10
0015195C: 41
0015195D: 00
0015195E: 02
0015195F: 24
Confirmed gameshark code write byte 1: A in: kon
Confirmed gameshark code write byte 2: 0 in: kon

Got pattern match in imo starting at base address: 001518D4
Got new write val offset at address: 001518D4
Got new game ver gameshark code: D01518D4 000A
alex@pop-os:~/dev/aprip$ ./aprip D0151952 1062  kon imo
APrip v1.0.6 By Alex Free (C)2022-2023 (3-BSD)
https://alex-free.github.io/aprip

Mode: GameShark code converter
Got old game ver gameshark code address D0151952
Got old game ver gameshark code type prefix: D0
Got old game RAM dump address 00151952
Got old game ver gameshark code base address 00151950
Got old game ver gameshark code base address offset for write value: 2
Got old game ver gameshark code value 1062
Write byte 1 in big endian 62
Write byte 2 in big endian 10
Loaded old game ver RAM dump file: kon (2097152 bytes in memory)
Loaded new game ver RAM dump file: imo (2097152 bytes in memory)
00151950: 0A
00151951: 00
00151952: 62
00151953: 10
00151954: 46
00151955: 00
00151956: 62
00151957: 28
00151958: 0E
00151959: 00
0015195A: 40
0015195B: 10
0015195C: 41
0015195D: 00
0015195E: 02
0015195F: 24
Confirmed gameshark code write byte 1: 62 in: kon
Confirmed gameshark code write byte 2: 10 in: kon

Got pattern match in imo starting at base address: 001518D4
Got new write val offset at address: 001518D6
Got new game ver gameshark code: D01518D6 1062

Full Bypass:

Test commands force OK:
D015205C 0062
8015205C 0014
D015205E 1202
8015205E 1800

Fake a VC0 without ReadTOC:
D01698B4 001E
801698B4 0000

Fake Non PAL BIOS:
D01518D4 000A
801518D4 0000
D01518D6 1062
D01518D6 0000